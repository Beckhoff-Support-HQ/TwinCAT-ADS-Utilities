<Window x:Class="AdsUtilitiesUI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:logging="clr-namespace:Microsoft.Extensions.Logging;assembly=Microsoft.Extensions.Logging.Abstractions"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Icon="/Images/icon.png"
        Title="ADS Utilities"
        Height="725"
        Width="830"
        ResizeMode="NoResize"
        WindowStyle="SingleBorderWindow"
        Background="WhiteSmoke">
    <Grid>
        <Grid.RowDefinitions>
            <!--Route Selection-->
            <RowDefinition Height="50" />
            <!--Main Area-->
            <RowDefinition Height="4*"/>
            <!--Logging Area-->
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!--Routes Selection-->
        <Grid Grid.Row="0" Margin=" 5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="auto"/>
                <ColumnDefinition Width="1*"/>
                <ColumnDefinition Width="auto"/>
                <ColumnDefinition Width="auto"/>
                <ColumnDefinition Width="auto"/>
                <ColumnDefinition Width="2*"/>

            </Grid.ColumnDefinitions>

            <TextBlock Text="Target:" Margin="10" VerticalAlignment="Center"/>
            <ComboBox Name="CmbBx_SelectRoute" 
              Grid.Column="1"
              ItemsSource="{Binding _targetService.AvailableTargets}" 
              DisplayMemberPath="DisplayName"
              SelectedItem="{Binding _targetService.CurrentTarget, Mode=TwoWay}" 
              Margin="5 5" 
              VerticalContentAlignment="Center">
                <ComboBox.ItemContainerStyle>
                    <Style TargetType="ComboBoxItem">
                        <Style.Triggers>
                            <!-- disable route entry if target is offline -->
                            <DataTrigger Binding="{Binding IsOnline}" Value="False">
                                <Setter Property="IsEnabled" Value="False"/>
                            </DataTrigger>
                        </Style.Triggers>

                    </Style>

                </ComboBox.ItemContainerStyle>
            </ComboBox>

            <Button Name="Bttn_Refresh"
                    Grid.Column="2"
                    Margin="5 5"
                    Command="{Binding ReloadRoutesCommand}"
                    Background="Transparent"
                    BorderThickness="0"
                    ToolTip="Reload Routes">
                <Button.Content>
                    <ContentControl Template="{StaticResource Icon_Refresh}" />
                </Button.Content>
            </Button>
            <Button Name="Bttn_RemoteControl"
                    Grid.Column="3"
                    Margin="5 5"
                    Command="{Binding RemoteConnectCommand}"
                    Background="Transparent"
                    BorderThickness="0"
                    ToolTip="Take Remote Control">
                <Button.Content>
                    <ContentControl Template="{StaticResource Icon_RC}" />
                </Button.Content>

            </Button>
            <Button
                x:Name="PowerButton"
                Grid.Column="4"
                Margin="5 5"
                Click="PowerButton_Click"
                Background="Transparent"
                BorderThickness="0"
                ToolTip="Power">
                <Button.Content>
                    <ContentControl Template="{StaticResource Icon_Power}" />

                </Button.Content>
                <Button.ContextMenu>
                    <ContextMenu x:Name="PowerMenu">
                        <MenuItem Header="Shut down" Command="{Binding ShutdownCommand}">
                            <MenuItem.Icon>
                                <ContentControl Template="{StaticResource Icon_Power}" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Restart" Command="{Binding RestartCommand}">
                            <MenuItem.Icon>
                                <ContentControl Template="{StaticResource Icon_Restart}" />
                            </MenuItem.Icon>
                        </MenuItem>
                    </ContextMenu>
                </Button.ContextMenu>

            </Button>

        </Grid>


        <!--Main Area-->
        <TabControl Grid.Row="1" Margin="0 15 0 0" Grid.RowSpan="1" Background="WhiteSmoke"
                    ItemsSource="{Binding Tabs}" SelectedItem="{Binding SelectedTab}">
            <TabControl.ItemTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding Title}" FontSize="12" Padding="7,3"/>
                </DataTemplate>
            </TabControl.ItemTemplate>
            <TabControl.ContentTemplate>
                <DataTemplate>
                    <Frame Content="{Binding Page}" NavigationUIVisibility="Hidden"/>
                </DataTemplate>
            </TabControl.ContentTemplate>

        </TabControl>

        <!--Logging Area-->
        <Grid Grid.Row="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- Menü / Toolbar -->
                <RowDefinition Height="*"/>
                <!-- DataGrid -->
            </Grid.RowDefinitions>

            <!-- Menü oben -->
            <Menu Grid.Row="0">
                <MenuItem Header="Filter" ItemsSource="{Binding LogLevelFilters}">
                    <MenuItem.ItemContainerStyle>
                        <Style TargetType="MenuItem">
                            <Setter Property="Header" Value="{Binding Level}" />
                            <Setter Property="IsCheckable" Value="True" />
                            <Setter Property="IsChecked"
                            Value="{Binding IsEnabled, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        </Style>
                    </MenuItem.ItemContainerStyle>
                </MenuItem>
                <MenuItem Header="Clear" Command="{Binding ClearCommand}" />
            </Menu>

            <!-- DataGrid füllt den Rest -->
            <DataGrid Grid.Row="1"
              ItemsSource="{Binding LogMessages}"
              AutoGenerateColumns="False"
              HeadersVisibility="Column"
              FontFamily="Consolas"
              FontSize="12"
              IsReadOnly="True"
              Margin="5"
              ScrollViewer.HorizontalScrollBarVisibility="Disabled"
              ScrollViewer.VerticalScrollBarVisibility="Visible"
              GridLinesVisibility="None">
                <DataGrid.Columns>
                    <DataGridTextColumn Binding="{Binding Timestamp, StringFormat={}{0:HH:mm:ss}}" Header="Time" Width="80"/>
                    <DataGridTextColumn Binding="{Binding LogLevel}" Header="Level" Width="80"/>
                    <DataGridTextColumn Binding="{Binding Message}" Header="Message" Width="*" />
                </DataGrid.Columns>
            </DataGrid>
        </Grid>

    </Grid>
</Window>
